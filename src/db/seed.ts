/**
 * @file src/db/seed.ts
 * @description Database Seeding Script
 *
 * à¹„à¸Ÿà¸¥à¹Œà¸™à¸µà¹‰à¸—à¸³à¸«à¸™à¹‰à¸²à¸—à¸µà¹ˆ:
 * 1. à¸ªà¸£à¹‰à¸²à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ˆà¸³à¸¥à¸­à¸‡ (Mock Data) à¸ªà¸³à¸«à¸£à¸±à¸š development/testing
 * 2. à¹ƒà¸Šà¹‰ Faker.js à¸ªà¸³à¸«à¸£à¸±à¸šà¸ªà¸£à¹‰à¸²à¸‡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸ªà¸¸à¹ˆà¸¡à¸—à¸µà¹ˆà¸ªà¸¡à¸ˆà¸£à¸´à¸‡
 * 3. Batch insert à¹€à¸à¸·à¹ˆà¸­à¸›à¸£à¸°à¸ªà¸´à¸—à¸˜à¸´à¸ à¸²à¸à¸ªà¸¹à¸‡à¸ªà¸¸à¸”
 *
 * à¸§à¸´à¸˜à¸µà¹ƒà¸Šà¹‰:
 * ```bash
 * bun run db:seed
 * ```
 *
 * à¸«à¸¡à¸²à¸¢à¹€à¸«à¸•à¸¸:
 * - à¹„à¸¡à¹ˆà¸„à¸§à¸£à¸£à¸±à¸™à¹ƒà¸™ production!
 * - à¸£à¸±à¸™à¸‹à¹‰à¸³à¹„à¸”à¹‰ (à¹à¸•à¹ˆà¸ˆà¸°à¹€à¸à¸´à¹ˆà¸¡à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸—à¸±à¸š à¹„à¸¡à¹ˆà¹„à¸”à¹‰à¸¥à¸šà¸‚à¸­à¸‡à¹€à¸”à¸´à¸¡)
 * - à¸–à¹‰à¸²à¸•à¹‰à¸­à¸‡à¸à¸²à¸£ reset à¹ƒà¸«à¹‰ drop table à¹à¸¥à¹‰à¸§ migrate à¹ƒà¸«à¸¡à¹ˆà¸à¹ˆà¸­à¸™
 */

import { db } from './index';
import { items } from './schema';
import { faker } from '@faker-js/faker';

// ============================================================
// CONFIGURATION
// ============================================================
/** à¸ˆà¸³à¸™à¸§à¸™ records à¸—à¸µà¹ˆà¸ˆà¸°à¸ªà¸£à¹‰à¸²à¸‡ */
const SEED_COUNT = 100;

// ============================================================
// MAIN SEEDING FUNCTION
// ============================================================
/**
 * Main function à¸ªà¸³à¸«à¸£à¸±à¸š seed database
 *
 * à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™:
 * 1. à¸ªà¸£à¹‰à¸²à¸‡ array à¸‚à¸­à¸‡ mock data
 * 2. Batch insert à¸¥à¸‡ database à¸—à¸µà¹€à¸”à¸µà¸¢à¸§ (à¹€à¸£à¹‡à¸§à¸à¸§à¹ˆà¸² insert à¸—à¸µà¸¥à¸°à¸•à¸±à¸§)
 * 3. Log à¸œà¸¥à¸¥à¸±à¸à¸˜à¹Œà¹à¸¥à¸° exit process
 */
const main = async () => {
  console.log('ğŸŒ± Seeding database...');

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // 1. Generate Mock Data
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /**
   * à¸ªà¸£à¹‰à¸²à¸‡ array à¸‚à¸­à¸‡ mock items
   * à¹ƒà¸Šà¹‰ faker.commerce.productName() à¹€à¸à¸·à¹ˆà¸­à¸ªà¸£à¹‰à¸²à¸‡à¸Šà¸·à¹ˆà¸­à¸ªà¸´à¸™à¸„à¹‰à¸²à¸ªà¸¸à¹ˆà¸¡
   *
   * @example
   * - "Rustic Concrete Keyboard"
   * - "Handcrafted Fresh Soap"
   * - "Incredible Granite Table"
   */
  const mockData = [];
  for (let i = 0; i < SEED_COUNT; i++) {
    mockData.push({
      name: faker.commerce.productName(),
      // à¹€à¸à¸´à¹ˆà¸¡ fields à¸­à¸·à¹ˆà¸™à¹† à¹„à¸”à¹‰à¸•à¸£à¸‡à¸™à¸µà¹‰:
      // description: faker.commerce.productDescription(),
      // price: parseFloat(faker.commerce.price()),
      // createdAt: faker.date.past(),
    });
  }

  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  // 2. Batch Insert to Database
  // â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  /**
   * Insert à¸—à¸µà¹€à¸”à¸µà¸¢à¸§à¸—à¸±à¹‰à¸‡ array (Batch Insert)
   *
   * à¸‚à¹‰à¸­à¸”à¸µ:
   * - à¹€à¸£à¹‡à¸§à¸à¸§à¹ˆà¸² insert à¸—à¸µà¸¥à¸° record à¸¡à¸²à¸
   * - à¸¥à¸” round-trip à¹„à¸› database
   * - Transaction à¹€à¸”à¸µà¸¢à¸§ (all-or-nothing)
   */
  await db.insert(items).values(mockData);

  console.log(`âœ… Seeded ${mockData.length} items successfully!`);
  process.exit(0);
};

// ============================================================
// EXECUTION
// ============================================================
/**
 * Execute main function with error handling
 * à¸–à¹‰à¸² seed à¹„à¸¡à¹ˆà¸ªà¸³à¹€à¸£à¹‡à¸ˆà¸ˆà¸° log error à¹à¸¥à¸° exit code 1
 */
main().catch((err) => {
  console.error('âŒ Seeding failed:', err);
  process.exit(1);
});
